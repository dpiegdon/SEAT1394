\documentclass{beamer}


\mode<presentation>
{
  \usetheme[compress]{Ilmenau}
	\useinnertheme{circles}
	\usecolortheme{lostrace}
  \setbeamercovered{transparent}
  \setbeamertemplate{navigation symbols}{}
}

%\usepackage{epsfig,graphicx,epsf}
\usepackage[ngerman]{babel}
\usepackage{ucs}
\usepackage[utf8x]{inputenc}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{multimedia}

\newenvironment{itemizeframe}[1]
  {\begin{frame}{#1}\startitemizeframe}
  {\stopitemizeframe\end{frame}}
\newcommand\startitemizeframe{\begin{itemize}}
\newcommand\stopitemizeframe{\end{itemize}}



\title[hacking in physically addressable memory]
{ { \small Seminar of Advanced Exploitation Techniques, WS 2006/2007} \\ \textbf{hacking in physically addressable memory}\\ a proof of concept}

\author[losTrace A.K.A. David R. Piegdon <david.rasmus.piegdon@rwth-aachen.de>]
{David~Rasmus~Piegdon \\ \ \\ \tiny Supervisor: Lexi Pimenidis}

\institute[RWTH Aachen University of Technology]{
	Lehrstuhl f\"ur Informatik IV, RWTH Aachen\\ {\tiny \ \\ http://www-i4.informatik.rwth-aachen.de \\} 
}

\date[2007-02-21]
{February 21st 2006}

\subject{Direct Memory Access hacking}

%\pgfdeclareimage[height=0.4cm]{by-nc-sa}{../bilder/by-nc-sa}
%\titlegraphic{\href{http://creativecommons.org/licenses/by-nc-sa/2.0/de/}{\pgfuseimage{by-nc-sa}}}

\pgfdeclareimage[height=1.0cm]{i4-1394}{i4_ieee1394_stacked}
\logo{\pgfuseimage{i4-1394}}

\pgfdeclareimage[height=1.0cm]{logo-1394}{ieee1394-logo-big}

%\pgfdeclareimage[height=3cm]{microkernel}{microkernel}
%\pgfdeclareimage[height=6cm]{monolith}{monolith}
%\pgfdeclareimage[height=19cm]{kernel-attackspace}{kernel-attackspace}


\begin{document}

\begin{frame}
	\titlepage
\end{frame}

\begin{frame}
	\frametitle{Gliederung}
	\tableofcontents[hideallsubsections]
\end{frame}

\AtBeginSection{
%	\begin{frame}
%	  \frametitle{Gliederung}
%	  \tableofcontents[hideallsubsections]
%	  % Die Option [pausesections] könnte nützlich sein.
%	\end{frame}
	\begin{frame}<beamer>
		\frametitle{Gliederung}
		\tableofcontents[current,hideallsubsections]
	\end{frame}
}

% "` "'
% umlaute "a ...

% \begin{exampleblock}	gruene box
% \begin{alertblock}	rote box
% \begin{Definition}	blaue box, titel "Definition"
% \begin{Example}	gruene box, titel "Example"
% \alert{...}		roter text
% \structure{...}	blauer text

\section{Introduction}

	\subsection{}

		\begin{frame}{physical addressable memory}
			"`hacking in physically addressable memory"'
			\begin{itemize}
				\item hacking: using a technique for something it has not been designed for.
				\item physically addressable memory: direct memory access, "`DMA"'
			\end{itemize}
		\end{frame}

		\begin{itemizeframe}{hacking}
			\item I will show mostly \structure{attacks}
			\item so actually I will be \structure{cracking} a systems security
			\item<2-> \alert{exploiting et al is not hacking by definition}
			\item<2-> \structure{"`to hack"' is mostly misused by media}
		\end{itemizeframe}

		\begin{itemizeframe}{DMA}
			\item DMA = Direct Memory Access
			\item basic requirement for introduced approach
			\item known for a long time: attacker has DMA -> \structure{0wn3d}
				\begin{itemize}
					\item 0wn3d by an iPod $[1]$
					\item and others $[2,3]$
				\end{itemize}
			\item this is a \structure{proof of concept}, nothing more
		\end{itemizeframe}

\section{Accessing memory}

	\subsection{Methods}

		\begin{frame} \frametitle{Methods}
			Many ways to gain access to memory:
			\begin{itemize}
				\item special PCI cards (forensic, remote management cards)
				\item special PCMCIA cards
				\item FireWire (IEEE1394) DMA feature
				\item anything with DMA
				\item \texttt{/dev/mem} (linux)
				\item memory dumps
				\item Suspend2Disk images
				\item Virtual machines
				\item \ldots
			\end{itemize}
		\end{frame}

		\begin{frame} \frametitle{DMA hardware}
			hardware we may use is
			\begin{itemize}
				\item expensive
				\item specially crafted
				\item selfmade (?)
				\item rare
				\item not hot-pluggable (?)
				\item \structure{one exception:} FireWire (IEEE1394)
			\end{itemize}
		\end{frame}

		\begin{frame}
			\alert{insert reference Joana Rutkovska here}

			http://theinvisiblethings.blogspot.com/2007/01/beyond-cpu-cheating-hardware-based-ram.html
		\end{frame}

	\subsection{FireWire}

		\begin{frame} \frametitle{FireWire overview}
			\pgfuseimage{logo-1394} FireWire, iLink, IEEE1394
			\begin{itemize}
				\item Expansion Bus (like PCI or PCMCIA)
				\item has DMA (if enabled by driver)
				\item guaranteed bandwith
				\item used alot for media-crunching ("`USB-BetaMax"')
				\item wide-spread (even among laptops)
				\item most people are not aware of abuse-factor
			\end{itemize}
		\end{frame}

		\begin{itemizeframe}{FireWire DMA}
			\item DMA only enabled if driver says so
			\begin{itemize}
				\item Linux, BSD, MacOSX: by default (can be disabled)
				\item Windows: only for devices that "`deserve"' (more later)
			\end{itemize}
			\item if DMA -> full access, no restrictions
		\end{itemizeframe}

		\begin{frame} \frametitle{Windows DMA}
			Devices that "`deserve"' DMA on windows:

			SBP2 (storage) devices, like
			\begin{itemize}
				\item external disks
				\item \structure{iPod} (has a disk)
			\end{itemize}

			\uncover<2->{The iPod can run Linux\ldots}
		\end{frame}
		
		\begin{itemizeframe}{How to identify SBP2}
			\item identify devices and features from their CSR \structure{config ROM}
			\item config ROM contains
			\begin{itemize}
				\item GUID: 8 byte globally unique ID (like MAC address)
				\item Identifier of driver
				\item List of supported features
				\item List of supported speeds
				\item \ldots
			\end{itemize}
			\item<2-> CSR config ROM can be faked (see [2])
			\item<3-> copy config ROM from iPod and install it on any system
			\item<4-> magically Windows permits DMA
		\end{itemizeframe}

			




\section{Virtual address spaces}

	\begin{frame}
		foo
	\end{frame}

\section{Gathering information}

	\begin{frame}
		foo
	\end{frame}

\section{Injecting code}

	\begin{frame}
		foo
	\end{frame}


\section{Prospects}

	\begin{frame}
		foo
	\end{frame}

\section{Conclusion}

	\begin{frame}
		foo
	\end{frame}

\section*{}

	\begin{frame}
		Questions?
	\end{frame}

	\begin{frame}
		\frametitle{Thanks\ldots}
		\begin{itemize}
			\item Maximillian Dornseif, Christian N. Klein and Michael Becher (basic idea)
			\item Lexi Pimenidis (supervisor)
			\item Timo Boettcher and Alexander Neumann
			\item Swantje Staar
			\item Chaos Computer Club Cologne
		\end{itemize}
		Thank you!
	\end{frame}

	\begin{itemizeframe}{Literatur}
		\item[1] \emph{Michael Becher, Maximillian Dornseif, and Christian N.
			Klein.} \structure{Firewire - all your memory are belong to us}, 2005.

		\item[2] \emph{Adam Boileau.} Ruxcon 2006: Hit by a bus: Physical access attacks with
			firewire, 2006.

		\item[3] \emph{Mariusz Burdach.} Finding digital evidence in physical memory, 2006.
	\end{itemizeframe}

	\begin{itemizeframe}{Literatur}
		\item[4] \emph{Rudi Cilibrasi and Paul M. B. Vit\'anyi.} Clustering by compression.
			IEEE transactions on information theory, vol. 51, 2005.

		\item[5] \emph{Otto Spaniol et al.} Systemprogrammierung, Skript zur Vorlesung an der RWTH
			Aachen. Wissenschaftsverlag Mainz; Aachener Beitraege zur Informatik (ABI),
			2002. ISBN 3-86073-470-9.
			
		\item[6] \emph{Intel Corp.} Intel 64 and IA-32 Architectures Software Developer’s Manual.

		\item[7] \emph{Bruce Schneier.} Applied Cryptography (Second Edition). John Wiley \& Sons,
			Inc, 1996. ISBN 0-471-11709-9.
	\end{itemizeframe}

\end{document}

