     1                                  ;
     2                                  ; $Id: print.s 330 2007-01-30 03:03:11Z lostrace $
     3                                  ;
     4                                  ; print.s: simple shellcode that just prints a statement and then exits
     5                                  ;
     6                                  ; Copyright (C) 2006,2007
     7                                  ; losTrace aka "David R. Piegdon"
     8                                  ;
     9                                  ; This program is free software; you can redistribute it and/or modify
    10                                  ; it under the terms of the GNU General Public License version 2, as
    11                                  ; published by the Free Software Foundation.
    12                                  ;
    13                                  ; This program is distributed in the hope that it will be useful,
    14                                  ; but WITHOUT ANY WARRANTY; without even the implied warranty of
    15                                  ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    16                                  ; GNU General Public License for more details.
    17                                  ;
    18                                  ; You should have received a copy of the GNU General Public License
    19                                  ; along with this program; if not, write to the Free Software
    20                                  ; Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
    21                                  ;
    22                                  
    23                                  BITS 32
    24                                  
    25 00000000 E820000000              	call		string_get_address
    26                                  	;                1234567890123456789012345678901
    27 00000005 666F6F626172323320-     	db		'foobar23 - marked by SEAT1394', 0xd, 0xa, 0
    28 0000000E 2D206D61726B656420-
    29 00000017 627920534541543133-
    30 00000020 39340D0A00         
    31                                  string_get_address:
    32 00000025 31C0                    	xor		eax,eax
    33 00000027 B004                    	mov		al, 4				; call write
    34 00000029 31DB                    	xor		ebx,ebx
    35 0000002B 43                      	inc		ebx				; stdout (1) as FD
    36 0000002C 59                      	pop		ecx				; string address
    37 0000002D 31D2                    	xor		edx,edx
    38 0000002F B220                    	mov		dl,0x20				; size of string
    39 00000031 CD80                    	int		0x80
    40                                  
    41                                  ;	xor		eax,eax
    42                                  ;	mov		al,6				; close stdin
    43                                  ;	xor		ebx,ebx
    44                                  ;	inc		ebx
    45                                  ;	int		0x80
    46                                  
    47 00000033 31C0                    	xor		eax,eax
    48 00000035 B001                    	mov		al,0x01
    49 00000037 31DB                    	xor		ebx,ebx				; exit code
    50 00000039 CD80                    	int		0x80
    51                                  
    52 0000003B C3                      	ret
